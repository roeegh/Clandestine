name: Deploy

on: [push]

jobs:
    Deploy:
        runs-on: ubuntu-latest
        
        steps:
          - uses: actions/checkout@v3
          - name: Copy repository contents via scp
            uses: appleboy/scp-action@master
            env:
                host: ${{ secrets.HOST }}
                username: ${{ secrets.USER }}
                port: ${{ secrets.PORT }}
                key: ${{ secrets.KEY }}
            with:
                source: "."
                target: "/home/ubuntu/Clandestine"
                rm: true

          - name: Executing remote command
            uses: appleboy/ssh-action@master
            with:
                host: ${{ secrets.HOST }}
                username: ${{ secrets.USER }}
                port: ${{ secrets.PORT }}
                key: ${{ secrets.KEY }}
                script: ls /home/ubuntu/Clandestine
