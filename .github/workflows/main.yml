name: Deploy

on: [push]

jobs:
    Deploy:
        runs-on: ubuntu-latest
        
        steps:
          - uses: actions/checkout@v3
          
          - name: Copy repository contents via scp
            uses: appleboy/scp-action@master
            with:
                HOST: ${{ secrets.HOST }}
                USERNAME: ${{ secrets.USER }}
                PORT: ${{ secrets.PORT }}
                KEY: ${{ secrets.KEY }}
                source: "./*"
                target: "/home/ubuntu/Clandestine"
                rm: true

          - name: Executing remote command
            uses: appleboy/ssh-action@master
            with:
                HOST: ${{ secrets.HOST }}
                USERNAME: ${{ secrets.USER }}
                PORT: ${{ secrets.PORT }}
                KEY: ${{ secrets.KEY }}
                script: ls -l
