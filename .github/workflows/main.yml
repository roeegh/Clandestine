name: Deploy

on: [push]

jobs:
    Deploy:
        runs-on: ubuntu-latest
        
        steps:
          - name: Copy repository contents via scp
            uses: appleboy/scp-action@master
            env:
                HOST: ${{ secrets.HOST }}
                USERNAME: ${{ secrets.USER }}
                PORT: ${{ secrets.PORT }}
                KEY: ${{ secrets.KEY }}
            with:
                source: "."
                target: "/home/ubuntu/Clandestine"
                rm: true

          - name: Executing remote command
            uses: appleboy/ssh-action@master
            with:
                host: ${{ secrets.HOST }}
                USERNAME: ${{ secrets.USER }}
                PORT: ${{ secrets.PORT }}
                KEY: ${{ secrets.KEY }}
                script: ls /home/ubuntu/Clandestine
